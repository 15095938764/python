新代码，有详细的注释，是最终用于提交比赛的代码。
2017-04-11
=======